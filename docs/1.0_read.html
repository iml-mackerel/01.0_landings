<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />



<meta name="date" content="2022-10-28" />

<title>Read</title>

<script src="site_libs/header-attrs-2.17/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/cosmo.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<link href="site_libs/highlightjs-9.12.0/textmate.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>






<link rel="stylesheet" href="styles.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}

.tocify-subheader {
  display: inline;
}
.tocify-subheader .tocify-item {
  font-size: 0.95em;
}

</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Mackerel landings</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="0.0_settings.html">
    <span class="fa fa-cogs"></span>
     
  </a>
</li>
<li>
  <a href="1.0_read.html">Read</a>
</li>
<li>
  <a href="2.0_overview.html">Overview</a>
</li>
<li>
  <a href="3.0_comparison.html">Comparison</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Read</h1>
<h4 class="date">2022-10-28</h4>

</div>


<div id="set-up" class="section level1" number="1">
<h1><span class="header-section-number">1</span> SET-UP</h1>
<pre class="r"><code>source(&#39;0.0_settings.R&#39;)</code></pre>
</div>
<div id="landings" class="section level1" number="2">
<h1><span class="header-section-number">2</span> Landings</h1>
<div id="ziff" class="section level2" number="2.1">
<h2><span class="header-section-number">2.1</span> ZIFF</h2>
<pre class="r"><code>sp_code &lt;- find.species(my.species,&#39;ziff&#39;)
kable(sp_code) </code></pre>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Mackerel bait (fishing licence only)</td>
<td align="right">248</td>
</tr>
<tr class="even">
<td align="left">Mackerel commercial (fishing licence)</td>
<td align="right">249</td>
</tr>
<tr class="odd">
<td align="left">Mackerel</td>
<td align="right">250</td>
</tr>
<tr class="even">
<td align="left">Exploratory mackerel (fishing licence)</td>
<td align="right">951</td>
</tr>
<tr class="odd">
<td align="left">Mackerel head</td>
<td align="right">960</td>
</tr>
</tbody>
</table>
<pre class="r"><code>ziffR &lt;- paste0(dir.rdat, &quot;ziff.Rdata&quot;)

if(!file.exists(ziffR)){
    ziff &lt;- read.ziff(sp_code,path=dir.ziff,year=my.year,language=&#39;en&#39;)
    
    # Species included:
    with(ziff, table(species,year))
    ziff &lt;- ziff[ziff$species==250,]   # code 960: few heads in 1996  code 951: wrong whelk

    save(ziff, file = ziffR)
}else{
    load(ziffR)
}</code></pre>
<div id="checks" class="section level3 tabset" number="2.1.1">
<h3 class="tabset"><span class="header-section-number">2.1.1</span>
CHECKS</h3>
<div id="areas" class="section level4" number="2.1.1.1">
<h4><span class="header-section-number">2.1.1.1</span> areas</h4>
<p>Nafo 5Y and 5Ze are partially in the US.</p>
<pre class="r"><code># NAFO 5 = landings in Canadian EEZ (northern contingent)
kable(with(ziff, table(nafo,month)))     </code></pre>
<table>
<colgroup>
<col width="6%" />
<col width="6%" />
<col width="6%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="9%" />
<col width="9%" />
<col width="9%" />
<col width="9%" />
<col width="9%" />
<col width="7%" />
<col width="6%" />
</colgroup>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">1</th>
<th align="right">2</th>
<th align="right">3</th>
<th align="right">4</th>
<th align="right">5</th>
<th align="right">6</th>
<th align="right">7</th>
<th align="right">8</th>
<th align="right">9</th>
<th align="right">10</th>
<th align="right">11</th>
<th align="right">12</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">2G</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">2J</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">2</td>
<td align="right">6</td>
<td align="right">60</td>
<td align="right">2</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">3K</td>
<td align="right">2</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">4</td>
<td align="right">8</td>
<td align="right">49</td>
<td align="right">270</td>
<td align="right">5823</td>
<td align="right">9901</td>
<td align="right">4539</td>
<td align="right">1556</td>
<td align="right">99</td>
</tr>
<tr class="even">
<td align="left">3L</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">12</td>
<td align="right">18</td>
<td align="right">12</td>
<td align="right">182</td>
<td align="right">1500</td>
<td align="right">3195</td>
<td align="right">1701</td>
<td align="right">585</td>
<td align="right">20</td>
</tr>
<tr class="odd">
<td align="left">3O</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">71</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">3PN</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">2</td>
<td align="right">0</td>
<td align="right">3</td>
<td align="right">83</td>
<td align="right">1056</td>
<td align="right">803</td>
<td align="right">585</td>
<td align="right">202</td>
<td align="right">3</td>
</tr>
<tr class="odd">
<td align="left">3PS</td>
<td align="right">3</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">7</td>
<td align="right">13</td>
<td align="right">107</td>
<td align="right">498</td>
<td align="right">1756</td>
<td align="right">862</td>
<td align="right">236</td>
<td align="right">133</td>
<td align="right">5</td>
</tr>
<tr class="even">
<td align="left">4R</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">7</td>
<td align="right">24</td>
<td align="right">98</td>
<td align="right">1521</td>
<td align="right">8146</td>
<td align="right">6837</td>
<td align="right">3925</td>
<td align="right">403</td>
<td align="right">2</td>
</tr>
<tr class="odd">
<td align="left">4S</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">26</td>
<td align="right">104</td>
<td align="right">632</td>
<td align="right">1170</td>
<td align="right">339</td>
<td align="right">54</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">4T</td>
<td align="right">5</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">175</td>
<td align="right">3677</td>
<td align="right">53146</td>
<td align="right">28262</td>
<td align="right">58878</td>
<td align="right">59502</td>
<td align="right">22131</td>
<td align="right">1714</td>
<td align="right">15</td>
</tr>
<tr class="odd">
<td align="left">4VN</td>
<td align="right">3</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">11</td>
<td align="right">1085</td>
<td align="right">3275</td>
<td align="right">1707</td>
<td align="right">2970</td>
<td align="right">5283</td>
<td align="right">3882</td>
<td align="right">136</td>
<td align="right">5</td>
</tr>
<tr class="even">
<td align="left">4VS</td>
<td align="right">0</td>
<td align="right">3</td>
<td align="right">57</td>
<td align="right">2</td>
<td align="right">58</td>
<td align="right">31</td>
<td align="right">20</td>
<td align="right">46</td>
<td align="right">7</td>
<td align="right">8</td>
<td align="right">5</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">4W</td>
<td align="right">774</td>
<td align="right">430</td>
<td align="right">366</td>
<td align="right">1240</td>
<td align="right">3932</td>
<td align="right">1959</td>
<td align="right">931</td>
<td align="right">1146</td>
<td align="right">1035</td>
<td align="right">982</td>
<td align="right">769</td>
<td align="right">473</td>
</tr>
<tr class="even">
<td align="left">4X</td>
<td align="right">70</td>
<td align="right">244</td>
<td align="right">157</td>
<td align="right">263</td>
<td align="right">6372</td>
<td align="right">6789</td>
<td align="right">3581</td>
<td align="right">6009</td>
<td align="right">6298</td>
<td align="right">3829</td>
<td align="right">2998</td>
<td align="right">120</td>
</tr>
<tr class="odd">
<td align="left">5Y</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">4</td>
<td align="right">0</td>
<td align="right">2</td>
<td align="right">7</td>
<td align="right">4</td>
<td align="right">4</td>
<td align="right">0</td>
<td align="right">2</td>
<td align="right">21</td>
<td align="right">11</td>
</tr>
<tr class="even">
<td align="left">5ZE</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">22</td>
<td align="right">0</td>
<td align="right">21</td>
<td align="right">31</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
</tbody>
</table>
</div>
<div id="na-weights" class="section level4" number="2.1.1.2">
<h4><span class="header-section-number">2.1.1.2</span> NA weights</h4>
<p>How many NA weights are there?</p>
<pre class="r"><code>na &lt;- cbind(all=with(ziff,table(year,useNA = &#39;always&#39;)),
                na=with(ziff[is.na(ziff$catch),],table(year,useNA = &#39;always&#39;)))
kable(na)</code></pre>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">all</th>
<th align="right">na</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">1985</td>
<td align="right">14767</td>
<td align="right">2</td>
</tr>
<tr class="even">
<td align="left">1986</td>
<td align="right">12769</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="left">1987</td>
<td align="right">14234</td>
<td align="right">6</td>
</tr>
<tr class="even">
<td align="left">1988</td>
<td align="right">9872</td>
<td align="right">5</td>
</tr>
<tr class="odd">
<td align="left">1989</td>
<td align="right">7392</td>
<td align="right">6</td>
</tr>
<tr class="even">
<td align="left">1990</td>
<td align="right">9654</td>
<td align="right">2</td>
</tr>
<tr class="odd">
<td align="left">1991</td>
<td align="right">10577</td>
<td align="right">8</td>
</tr>
<tr class="even">
<td align="left">1992</td>
<td align="right">8498</td>
<td align="right">6</td>
</tr>
<tr class="odd">
<td align="left">1993</td>
<td align="right">10246</td>
<td align="right">3</td>
</tr>
<tr class="even">
<td align="left">1994</td>
<td align="right">9993</td>
<td align="right">33</td>
</tr>
<tr class="odd">
<td align="left">1995</td>
<td align="right">10199</td>
<td align="right">90</td>
</tr>
<tr class="even">
<td align="left">1996</td>
<td align="right">12636</td>
<td align="right">49</td>
</tr>
<tr class="odd">
<td align="left">1997</td>
<td align="right">11238</td>
<td align="right">50</td>
</tr>
<tr class="even">
<td align="left">1998</td>
<td align="right">11051</td>
<td align="right">36</td>
</tr>
<tr class="odd">
<td align="left">1999</td>
<td align="right">9107</td>
<td align="right">35</td>
</tr>
<tr class="even">
<td align="left">2000</td>
<td align="right">10137</td>
<td align="right">20</td>
</tr>
<tr class="odd">
<td align="left">2001</td>
<td align="right">7466</td>
<td align="right">26</td>
</tr>
<tr class="even">
<td align="left">2002</td>
<td align="right">8935</td>
<td align="right">17</td>
</tr>
<tr class="odd">
<td align="left">2003</td>
<td align="right">12322</td>
<td align="right">39</td>
</tr>
<tr class="even">
<td align="left">2004</td>
<td align="right">12760</td>
<td align="right">19</td>
</tr>
<tr class="odd">
<td align="left">2005</td>
<td align="right">20695</td>
<td align="right">74</td>
</tr>
<tr class="even">
<td align="left">2006</td>
<td align="right">14757</td>
<td align="right">23</td>
</tr>
<tr class="odd">
<td align="left">2007</td>
<td align="right">9453</td>
<td align="right">39</td>
</tr>
<tr class="even">
<td align="left">2008</td>
<td align="right">6601</td>
<td align="right">10</td>
</tr>
<tr class="odd">
<td align="left">2009</td>
<td align="right">8323</td>
<td align="right">6</td>
</tr>
<tr class="even">
<td align="left">2010</td>
<td align="right">9570</td>
<td align="right">5</td>
</tr>
<tr class="odd">
<td align="left">2011</td>
<td align="right">7094</td>
<td align="right">21</td>
</tr>
<tr class="even">
<td align="left">2012</td>
<td align="right">5866</td>
<td align="right">37</td>
</tr>
<tr class="odd">
<td align="left">2013</td>
<td align="right">4999</td>
<td align="right">18</td>
</tr>
<tr class="even">
<td align="left">2014</td>
<td align="right">4465</td>
<td align="right">24</td>
</tr>
<tr class="odd">
<td align="left">2015</td>
<td align="right">4772</td>
<td align="right">26</td>
</tr>
<tr class="even">
<td align="left">2016</td>
<td align="right">6819</td>
<td align="right">27</td>
</tr>
<tr class="odd">
<td align="left">2017</td>
<td align="right">11416</td>
<td align="right">50</td>
</tr>
<tr class="even">
<td align="left">2018</td>
<td align="right">8590</td>
<td align="right">23</td>
</tr>
<tr class="odd">
<td align="left">2019</td>
<td align="right">8045</td>
<td align="right">457</td>
</tr>
<tr class="even">
<td align="left">2020</td>
<td align="right">7894</td>
<td align="right">317</td>
</tr>
<tr class="odd">
<td align="left">2021</td>
<td align="right">3509</td>
<td align="right">42</td>
</tr>
<tr class="even">
<td align="left">NA</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
</tbody>
</table>
</div>
<div id="weights" class="section level4" number="2.1.1.3">
<h4><span class="header-section-number">2.1.1.3</span> 0 weights</h4>
<p>How many 0 weights are there?</p>
<pre class="r"><code>with(ziff[!is.na(ziff$catch) &amp; ziff$catch==0,],table(year))
## &lt; table of extent 0 &gt;</code></pre>
</div>
<div id="jan-1" class="section level4" number="2.1.1.4">
<h4><span class="header-section-number">2.1.1.4</span> Jan-1</h4>
<p>Check that there is no abnormal quantity of landings on January first
(possibly records for which data is unknown).</p>
<pre class="r"><code>ggplot(ziff,aes(x=lubridate::yday(capt.date)))+geom_histogram(binwidth = 1)+
    scale_x_continuous(expand=c(0,0))+
    scale_y_continuous(expand=c(0,0))
## Warning: Removed 189026 rows containing non-finite values (stat_bin).</code></pre>
<p><img src="1.0_read_files/figure-html/ZIFF_jan1-1.png" width="864" style="display: block; margin: auto;" /></p>
</div>
<div id="npbc" class="section level4" number="2.1.1.5">
<h4><span class="header-section-number">2.1.1.5</span> NPBC</h4>
<p>There are 3 special nbpc numbers that indicate landings that are not
necessarily daily (e.g., monthly totals) or for which the data is only
approximate. For instance, B00000 landings seems to be on the first of
last of a certain month. For analyses of daily landings these might need
to be excluded.</p>
<pre class="r"><code>kable(with(ziff[ziff$npbc %in% c(&#39;000000&#39;, &#39;B00000&#39;, &#39;190000&#39;),], table(year,npbc)))  </code></pre>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">000000</th>
<th align="right">190000</th>
<th align="right">B00000</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">1985</td>
<td align="right">1371</td>
<td align="right">224</td>
<td align="right">523</td>
</tr>
<tr class="even">
<td align="left">1986</td>
<td align="right">851</td>
<td align="right">207</td>
<td align="right">1266</td>
</tr>
<tr class="odd">
<td align="left">1987</td>
<td align="right">934</td>
<td align="right">195</td>
<td align="right">1214</td>
</tr>
<tr class="even">
<td align="left">1988</td>
<td align="right">785</td>
<td align="right">111</td>
<td align="right">849</td>
</tr>
<tr class="odd">
<td align="left">1989</td>
<td align="right">685</td>
<td align="right">184</td>
<td align="right">953</td>
</tr>
<tr class="even">
<td align="left">1990</td>
<td align="right">752</td>
<td align="right">224</td>
<td align="right">743</td>
</tr>
<tr class="odd">
<td align="left">1991</td>
<td align="right">719</td>
<td align="right">97</td>
<td align="right">748</td>
</tr>
<tr class="even">
<td align="left">1992</td>
<td align="right">567</td>
<td align="right">127</td>
<td align="right">764</td>
</tr>
<tr class="odd">
<td align="left">1993</td>
<td align="right">463</td>
<td align="right">99</td>
<td align="right">800</td>
</tr>
<tr class="even">
<td align="left">1994</td>
<td align="right">589</td>
<td align="right">136</td>
<td align="right">1020</td>
</tr>
<tr class="odd">
<td align="left">1995</td>
<td align="right">514</td>
<td align="right">98</td>
<td align="right">920</td>
</tr>
<tr class="even">
<td align="left">1996</td>
<td align="right">334</td>
<td align="right">190</td>
<td align="right">398</td>
</tr>
<tr class="odd">
<td align="left">1997</td>
<td align="right">131</td>
<td align="right">229</td>
<td align="right">598</td>
</tr>
<tr class="even">
<td align="left">1998</td>
<td align="right">13</td>
<td align="right">0</td>
<td align="right">359</td>
</tr>
<tr class="odd">
<td align="left">1999</td>
<td align="right">8</td>
<td align="right">0</td>
<td align="right">413</td>
</tr>
<tr class="even">
<td align="left">2000</td>
<td align="right">22</td>
<td align="right">7</td>
<td align="right">8</td>
</tr>
<tr class="odd">
<td align="left">2001</td>
<td align="right">16</td>
<td align="right">7</td>
<td align="right">654</td>
</tr>
<tr class="even">
<td align="left">2002</td>
<td align="right">19</td>
<td align="right">6</td>
<td align="right">256</td>
</tr>
<tr class="odd">
<td align="left">2003</td>
<td align="right">462</td>
<td align="right">7</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">2004</td>
<td align="right">454</td>
<td align="right">7</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">2005</td>
<td align="right">201</td>
<td align="right">7</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">2006</td>
<td align="right">838</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">2007</td>
<td align="right">371</td>
<td align="right">7</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">2008</td>
<td align="right">1011</td>
<td align="right">8</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">2009</td>
<td align="right">1171</td>
<td align="right">8</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">2010</td>
<td align="right">0</td>
<td align="right">8</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">2011</td>
<td align="right">0</td>
<td align="right">8</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">2012</td>
<td align="right">0</td>
<td align="right">8</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">2013</td>
<td align="right">0</td>
<td align="right">8</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">2014</td>
<td align="right">0</td>
<td align="right">8</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">2015</td>
<td align="right">0</td>
<td align="right">8</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">2016</td>
<td align="right">0</td>
<td align="right">8</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">2017</td>
<td align="right">0</td>
<td align="right">8</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">2018</td>
<td align="right">0</td>
<td align="right">8</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">2019</td>
<td align="right">0</td>
<td align="right">8</td>
<td align="right">0</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="nafo" class="section level2" number="2.2">
<h2><span class="header-section-number">2.2</span> NAFO</h2>
<pre class="r"><code>nafoAR &lt;- paste0(dir.rdat, &quot;nafoA.Rdata&quot;)
nafoBR &lt;- paste0(dir.rdat, &quot;nafoB.Rdata&quot;)

if(!all(file.exists(c(nafoAR,nafoBR)))){
    ### NAFO database A (annual) ---------------------------------
    sp_code &lt;- find.species(my.species,&#39;nafoA&#39;);sp_code
    nafoA &lt;- read.nafoA(paste0(dir.nafo,&#39;statlandA.csv&#39;),species=sp_code[1], year=my.year) 

    # Canadian caught mackerel outside of my.nafo
    with(nafoA[!grepl(paste0(my.nafo, collapse = &quot;|&quot;),nafoA$nafo)&amp;
                 grepl(&#39;canada&#39;,nafoA$country,ignore.case = TRUE),] ,table(year,nafo))

    # only keep my.nafo; other areas are NOT from nothern contingent (winter months in US or Europe)
    nafoA &lt;- nafoA[grepl(paste0(my.nafo, collapse = &quot;|&quot;),nafoA$nafo),] 
    table(nafoA$nafo)
    
    save(nafoA, file = nafoAR)
    
    ### NAFO data base B (monthly) ---------------------------------
    sp_code &lt;- find.species(my.species,&#39;nafoB&#39;);sp_code
    nafoB &lt;- read.nafoB(path=dir.nafo,species=sp_code[1],year=my.year,overwrite=FALSE)  # overwrite=TRUE if new download   

    # Canadian caught mackerel outside of my.nafo
    with(nafoB[!grepl(paste0(my.nafo, collapse = &quot;|&quot;),nafoB$nafo)&amp;
                 grepl(&#39;canada&#39;,nafoB$country,ignore.case = TRUE),] ,table(year,nafo))
    with(nafoB[!grepl(paste0(my.nafo, collapse = &quot;|&quot;),nafoB$nafo)&amp;
                 grepl(&#39;canada&#39;,nafoB$country,ignore.case = TRUE),] ,table(month,nafo))
    
    # only keep my.nafo  (though 5Ze in summer; wouldn&#39;t they be northern contingent fish??)
    nafoB &lt;- nafoB[grepl(paste0(my.nafo, collapse = &quot;|&quot;),nafoB$nafo),] 
    table(nafoB$nafo)
    
    # remove useless columns 
    nafoB &lt;- nafoB[,c(&#39;year&#39;,&#39;month&#39;,&#39;country&#39;,&#39;nafo&#39;,&#39;gear&#39;,&#39;gear.cat&#39;,&#39;tonnage.class&#39;,&#39;prov&#39;,&#39;catch&#39;)]

    save(nafoB, file = nafoBR)
}else{
    load(nafoAR)
    load(nafoBR)
}</code></pre>
<div id="check" class="section level3 tabset" number="2.2.1">
<h3 class="tabset"><span class="header-section-number">2.2.1</span>
CHECK</h3>
<p>Nafo B is used for landings prior to 1995.</p>
<div id="compare" class="section level4" number="2.2.1.1">
<h4><span class="header-section-number">2.2.1.1</span> compare</h4>
<pre class="r"><code>ggplot()+
    geom_bar(data=nafoA,aes(x=year,y=catch,fill=&quot;Nafo A&quot;),stat=&#39;identity&#39;,alpha=0.4)+
    geom_bar(data=nafoB,aes(x=year,y=catch,fill=&quot;Nafo B&quot;),stat=&#39;identity&#39;,alpha=0.4)+
    geom_vline(xintercept=1985)+
    labs(fill=&#39;&#39;,y=&#39;Landings (t)&#39;,x=&#39;Year&#39;)+
    scale_x_continuous(expand=c(0,0))+ scale_y_continuous(expand=c(0,0))</code></pre>
<p><img src="1.0_read_files/figure-html/NAFO_comparison-1.png" width="864" style="display: block; margin: auto;" /></p>
</div>
</div>
</div>
<div id="catch-nafo-ziff" class="section level2" number="2.3">
<h2><span class="header-section-number">2.3</span> CATCH = NAFO +
ZIFF</h2>
<pre class="r"><code>## bind both
ziff$source &lt;-&#39;ziff&#39;
ziff$catch &lt;- ziff$catch/1000            # kg to tonnes
ziff$country &lt;- &#39;Canada&#39;                 # consistency with nafo
ziff$prov &lt;- ifelse(ziff$prov.land==&#39;Unknown&#39;,as.character(ziff$prov.home),as.character(ziff$prov.land))

nafoB$source &lt;- &#39;nafo&#39;                   # work with detailed B base

sel &lt;- c(&#39;year&#39;,&#39;month&#39;,&#39;nafo&#39;,&#39;gear.cat&#39;,&#39;source&#39;,&#39;catch&#39;,&#39;country&#39;,&#39;prov&#39;)
catch &lt;- rbind(ziff[ziff$year&gt;=1995,sel],        # ziff from 1995 onwards
               nafoB[nafoB$year&lt;1995,sel],       # nafoB before
               nafoB[nafoB$year&gt;=1995 &amp; nafoB$country!=&#39;Canada&#39;,sel]) # foreign post 1994

save(catch, file = paste0(dir.rdat, &quot;catch.Rdata&quot;))

plotCatch(catch,x=&#39;year&#39;,y=&#39;catch&#39;)
## Warning in xtfrm.data.frame(x): cannot xtfrm data frames
## Warning: Removed 1580 rows containing missing values (position_stack).</code></pre>
<p><img src="1.0_read_files/figure-html/CATCH-1.png" width="864" style="display: block; margin: auto;" /></p>
</div>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeCodeFolding("show" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = false;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
